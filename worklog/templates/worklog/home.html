{% extends "worklog/base.html" %}
{% load staticfiles %}

{% block content %}
    <script type="text/javascript" src="{% static 'js/lib/chart.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/lib/chart.legend.js' %}"></script>

    <!-- Outstanding Work -->
    <div>
        <h2>Outstanding Work Days:</h2>
        <p>
            {% for date, url in outstanding_work.items %}
                <a href="{% url 'worklog-date' date %}">{{ date }}</a>
                <br></br>
            {% endfor %}
        </p>
    </div>

    <!-- Total Hours -->
    <div>
        <h2>Total hours this week:</h2>
        <h1>{{ total_hours }}</h1>
    </div>

    <!-- Work Chart -->
    <div class="row">
        <div class="col-md-6">
            <h2>Total hours per day:</h2>
            <table class="table table-bordered">
                <tr> <!-- Print column titles (days of week) -->
                    {% for day, hours in hours_per_day.iteritems %}
                        <th>{{ day }}</th>
                    {% endfor %}
                </tr>

                <tr>  <!-- Print hours for each day -->
                    {% for day, hours in hours_per_day.iteritems %}
                        <td>{{ hours }}</td>
                    {% endfor %}
                </tr>
            </table>
        </div>
    </div>

    <!-- Assigned Issues -->
    <div>

    </div>

    <!-- Job Time Chart -->
    <div>
        <h2>Hours per job breakdown:</h2>
        <style>
        #fork {
            position: absolute;
            top: 0;
            right: 0;
            border: 0;
        }

        .legend {
            width: 10em;
            border: 1px solid black;
        }

        .legend .title {
            display: block;
            margin: 0.5em;
            border-style: solid;
            border-width: 0 0 0 1em;
            padding: 0 0.3em;
        }
        </style>
        <canvas id="jobChart" width="300" height="300"></canvas>
        <div id="jobLegend" width="100" height="200"></div>

        <script type="text/javascript">
            var data = [
                {% for job, hours in hours_per_job.items %}
                    {
                        value: {{ hours }},
                        color: "{{ color_pool.next }}",
                        label: "{{ job }}",
                        title: "{{ job }}"
                    },
                {% endfor %}
            ]

            var options = {
                segmentShowStroke : true,
                segmentStrokeWidth : 4,
                percentageInnerCutout : 50,
                tooltipFontSize: 16,
                animateScale : false,
                animationSteps : 75,
                animationEasing : "easeOutBounce",
            }

            var ctx = document.getElementById('jobChart').getContext('2d');
            var jobChart = new Chart(ctx).Doughnut(data, options);
            legend(document.getElementById('jobLegend'), data);
        </script>
    </div>
{% endblock %}